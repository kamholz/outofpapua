CREATE OR REPLACE VIEW language_ancestor AS
SELECT language.id, ancestor.id AS ancestor_id
FROM language
LEFT JOIN LATERAL (
  WITH RECURSIVE ancestor(id) AS (
    SELECT language2.id, language2.parent_id
    FROM language language2
    WHERE language2.id = language.id
    UNION ALL
    SELECT language2.id, language2.parent_id
    FROM ancestor
    JOIN language language2 ON language2.id = ancestor.parent_id
  )
  SELECT ancestor.id, language.name
  FROM ancestor
  JOIN language ON language.id = ancestor.id
  WHERE ancestor.parent_id IS NULL
) ancestor ON true;